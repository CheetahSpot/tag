<!DOCTYPE html>
<html>
  <head>
    <title>Spot Test</title>

    <!-- Sample of custom inline code -->
    <script>
      // Initialize data layer so events can be pushed even before spot.js loads
      var spot_data = [];
      // Create a convenience funtion to push events
      function pushEvent(evt) {
        spot_data.push(evt);
      }
      // Push config to data layer
      pushEvent({ "config": { apiHost: "https://growingtree.demostellar.com", apiAuth: "Bearer 7ed9828b0021035c22f1b142db14704bc4eb95b11f93d973bd9c9b698cf736e4:3e1824ff3ec2d7e2e20c13fa00d60d4dbc4a965d5fd48a1f4887338759c1d8e7" } });
      //pushEvent({ apiHost: "https://api-cust100.demostellar.com", apiAuth: "Bearer 9d93dd6d82531de07978181313a29978bab3c4c0a3112cbe527e10cd1c3add8d:27ceca09315271167c9c88859fe02965716d7f8d844055eb354dff659cc569d9" });
      // Push a web visit event to the data layer
      pushEvent({ "type": 'web', "params": { "subtype": "visit", "url": document.location.href, "referrer": document.referrer } });

      // Define some events I want to capture
      var customEvents = {
        "add_to_cart":      { type: "cart", "params": { 'subtype': 'add', 'item': 'sammich' } },
        "remove_from_cart": { type: "cart", "params": { 'subtype': 'remove', 'item': 'sammich' }, "after": "afterRemoveFromCart" },
        "cart_checkout":    { type: "cart", "params": { 'subtype': 'checkout', 'item': 'sammich' }, "before": "beforeCartCheckout", "after": "afterCartCheckout", "cancel": "cancelCartCheckout" },
        "identify":         { type: "identify", "params": { 'ut': 'Paul000002_usrtok', 'utAttr': 'user_token' } },
        "email_identify":   { type: "identify", "params": { 'ut': 'paul@example.com', 'utAttr': 'email' }, "after": "afterSignin" },
        "signin":           { type: "signin", "params": { 'ut': 'Paul000001_intid', 'utAttr': 'integration_id', "first_name": "Paul" } },
        "signout":          { type: "signout" },
        "optin":            { type: "optin" },
        "optout":           { type: "optout" }
      }

      function afterRemoveFromCart (data) { alert("item removed"); }
      function beforeCartCheckout (data) { return confirm("confirm checkout") }
      function afterCartCheckout (data) { alert("thanks for your purchase!") }
      function cancelCartCheckout (data) { alert("items will remain in your cart for 24 hours") }
      function afterSignin (data) { alert("welcome "+data.params.first_name+"!"); }

      // Trigger on button click
      document.addEventListener('click', function (event) {
        if (event.target.matches('.btn')) {
          event.preventDefault();
          console.log("custom button click id =", event.target.id, event.target);
          let evt = customEvents[event.target.id];
          if (!evt) {
            evt = { type: event.target.id };
          }
          pushEvent(evt);
        }
      }, false);

    </script>
    <!-- End sample code -->

    <!-- Spot Script -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'spot.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://cheetahspot.github.io/tag/spot.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','SPOT-000001');</script>
    <!-- End Spot Script -->

    <!-- make the page look nice -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="https://v4-alpha.getbootstrap.com/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://v4-alpha.getbootstrap.com/examples/narrow-jumbotron/narrow-jumbotron.css">
  </head>
  <body>
    <div class="container">

      <div class="header clearfix">
        <nav>
          <ul class="nav nav-pills float-right">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="gtm.html">GTM</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="cust100.html">Inline C100</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="growingtree.html">Inline GT</a>
            </li>
          </ul>
        </nav>
        <h3 class="text-muted">Spot Test</h3>
      </div>

      <div class="jumbotron">
        <h1>Spot Test - Inline</h1>
        <p class="lead">This is a set of tests for Spot using simple inline code. View page source to see the code.</p>
      </div>

      <div class="jumbotron">
        <h1>Visitors</h1>
        <p class="lead">Spot automatically creates a unique device_token for the browser on first visit.
        This is stored in the "spot_dt" cookie and will identify the device even if the user is subsequently identified.</p>
        <p class="lead">Spot can automatically submit an "web visit" Event for the page visit, or you push a custom event to the data layer:</p>
        <code>spot_data.push({ type:"web", params: { subtype: "visit", url: "{url}", referrer: "{referrer}", user_agent: "{useragent}"} })</code>
        <p class="lead">An anonymous event for a device_token will result in a new member record.</p>
      </div>

      <div class="jumbotron">
        <h1>User Identification</h1>
        <p class="lead">If a user signs in or is otherwise identified, an "identify" event is submitted with the user identifier.</p>
        <p class="lead">A user identifier is also stored in the "spot_ut" cookie.
        Cookie values that appear to be email addresses will be redacted (the cookie value set to "redacted").</p>
        <p>
          <a class="btn btn-lg btn-primary" href="#" id="identify" role="button" onclick="">Identify</a>
          <a class="btn btn-lg btn-info" href="#" id="email_identify" role="button" onclick="">Email Identify</a>
          <a class="btn btn-lg btn-success" href="#" id="signin" role="button" onclick="">Sign in</a>
        </p>
        <p class="lead">If the web page submits a "signout" event, the user token cookie will be redacted.</p>
        <p>
          <a class="btn btn-lg btn-warning" href="#" id="signout" role="button">Sign out</a>
        </p>
        <p class="lead">A "spot_user" querystring parameter or javascript variable can be used to identify the user.
        The value of spot_user is a JSON object with parameters "ut" (user_token) and optionally "utAttr" (user_token attribute).
        The value can be base64 encoded or plain text.</p>
        <p>Querystring parameter:</p>
        <p><a href='?spot_user={"ut":"paul00002_email"}'>?spot_user={"ut":"paul00002_email"}</a></p>
        <p><a href='?spot_user=eyJ1dCI6InBhdWwwMDAwMl9lbWFpbCJ9'>?spot_user=eyJ1dCI6InBhdWwwMDAwMl9lbWFpbCJ9</a></p>
        <p><a href='?spot_user={"ut":"paul00002_email","utAttr":"integration_id"}'>?spot_user={"ut":"paul00002_email","utAttr":"integration_id"}</a></p>
        <p>JavaScript variable:</p>
        <p><code>var spot_user={"ut":"paul00002_email"};</code></p>
        <p><code>var spot_user="eyJ1dCI6InBhdWwwMDAwMl9lbWFpbCJ9";</code></p>
      </div>

      <div class="jumbotron">
        <h1>Abandoned Cart</h1>
        <p class="lead">Click buttons to trigger events to test abandoned cart.
          Each button pushes an event onto the data layer.
          Spot detects updates to the data layer and submits EDP Events.
        </p>
        <p>
          <a class="btn btn-lg btn-primary" href="#" id="add_to_cart" role="button">Add to Cart</a>
          <a class="btn btn-lg btn-info" href="#" id="remove_from_cart" role="button">Remove from Cart</a>
          <a class="btn btn-lg btn-success" href="#" id="cart_checkout" role="button">Checkout</a>
        </p>
      </div>

      <div class="jumbotron">
        <h1>Managing User Consent</h1>
        <p class="lead">
        Spot supports user consent to tracking, using a "Do Not Track" cookie.
        </p>
        <p>
          <a class="btn btn-lg btn-success" href="#" id="optin" role="button">Optin</a>
          <a class="btn btn-lg btn-warning" href="#" id="optout" role="button">Optout</a>
        </p>
        <p>
        Tracking is enabled by default.
        An optin or optout Event out sets a Do Not Track cookie "spot_dnt".  Optin sets "spot_dnt=0", and Optout sets "spot_dnt=1".  </p>
        <p>After Do Not Track is enabled ("spot_dnt=1") Events are blocked and not sent to the server. Optin/optout does not affect other cookies.  </p>
      </div>
    
    </div>
  </body>
</html>
